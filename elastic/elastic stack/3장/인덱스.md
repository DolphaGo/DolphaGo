# 인덱스
- [인덱스](#인덱스)
  - [인덱스 CRUD](#인덱스-crud)
    - [인덱스 생성](#인덱스-생성)
    - [인덱스 조회](#인덱스-조회)
    - [인덱스 삭제](#인덱스-삭제)
    - [인덱스 내 설정 수정해보기](#인덱스-내-설정-수정해보기)

<br/>

- 인덱스는 도큐먼트를 저장하는 논리적인 단위 (RDB의 테이블과 유사한 개념)
- 하나의 인덱스에 다수의 도큐먼트가 포함되는 구조. 동일한 인덱스에 있는 도큐먼트는 동일한 스키마를 갖는다.
- **모든 도큐먼트는 반드시 하나의 인덱스에 포함되어 있어야 한다.**
- 인덱스의 이름으로는 영어 소문자와 \,/,*,?,",<,>,|,#, 공백, 쉼표 등을 **제외한** 특수문자를 사용할 수 있음. 이름 길이가 255바이트를 넘을 수는 없음
- 인덱스가 커지면 검색시 많은 도큐먼트를 참조해야 하기 때문에 성능이 나빠짐

## 인덱스 CRUD

REST API를 이용한다.

### 인덱스 생성
![](/images/2022-03-16-23-46-00.png)

- PUT : 생성이나 수정을 위한 HTTP method (여기서는 POST를 사용해도 된다.)
- 여기서 index1은 생성하려는 엘라스틱서치 인덱스 이름

### 인덱스 조회
![](/images/2022-03-16-23-47-06.png)

### 인덱스 삭제
![](/images/2022-03-16-23-47-34.png)


### 인덱스 내 설정 수정해보기

예를 들어 키바나에서 스토리지 용량이 부족해지면 특정 인덱스를 read_only로 바꾸는데, 이 값을 바꾸지 않게 하려면 read_ony_allow_delete 라는 옵션을 false로 변경해줘야 한다. 아마 GET 을 해보면 이 값이 true로 나와있을 것이다.

```sh
curl -XPUT 'http://localhost:9200/.kibana_1/_settings' -H 'Content-Type: application/json' -d '{
"index": {
    "blocks": {
        "read_only_allow_delete": "false"
        }
    }
}'
```
**인덱스를 삭제하면 인덱스에 저장되어 있는 도큐먼트들도 모두 삭제되니 주의해야한다.**
